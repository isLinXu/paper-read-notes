# YOLOD

**标题：** High-Performance Fine Defect Detection in Artificial Leather Using Dual Feature Pool Object Detection

**作者：** Lin Huang, Weisheng Li, Linlin Shen, Xue Xiao, Suihan Xiao

**机构：** 重庆邮电大学，深圳大学，浪潮工业互联网有限公司，重庆振远创新科技有限公司

**摘要：**

- 论文分析了YOLOv5模型的结构问题，并针对人造革细小缺陷的特征，设计了四种创新结构：DFP（Dual Feature Pool），IFF（Interference Feature Filtering），AMP（Adaptive Multi Positives），和EOS（Eliminate Output Sensitivity）。
- 提出了一种高性能的人造革细小缺陷检测模型YOLOD，该模型在人造革缺陷数据集上表现出色，与YOLOv5相比，AP50提高了11.7% - 13.5%，误检率降低了5.2% - 7.2%。
- YOLOD在通用的MS-COCO数据集上也表现出色，与YOLOv5相比，AP提高了0.4% - 2.6%，APS提高了2.5% - 4.1%。

**关键词：** 目标检测、缺陷检测、人造革、细小缺陷

**1. 引言：**

- 人造革在多个行业中因其成本效益和环保特性而广受欢迎。
- 传统的人造革缺陷检测主要依赖人眼，存在效率和准确性的局限性。
- 深度学习的发展为实时目标检测技术带来了显著进步。

**2. 数据集：**

- 使用了MS-COCO数据集和人造革数据集（ALD）进行评估。

**3. YOLOD：**

- 提出了DFP结构来增强小目标检测网络的深度或宽度。
- IFF模块用于评分和筛选通道特征图，以提高特征质量。
- AMP方法改进了YOLOv5的正样本增加策略。
- EOS方法改进了YOLOv4中引入的消除网格敏感性的方法。

**4. 实验：**

- 在ALD上比较了YOLOD和YOLOv5-r5.02的缺陷检测能力。
- 在MS-COCO数据集上验证了YOLOD的性能。

**5. 实验结果：**

- YOLOD在ALD上的AP50显著高于YOLOv5，误检率也更低。
- 在MS-COCO数据集上，YOLOD的AP超过了YOLOv5，尤其是在小目标的检测上。

**6. 结论：**

- YOLOD在MS-COCO数据集上比YOLOv5有更高的AP，对推理速度影响很小。
- 在ALD上，YOLOD展现了比YOLOv5更好的AP和更低的AE，有效解决了小目标检测问题。

回答问题

**1. 这篇论文做了什么工作，它的动机是什么？** 论文提出了一个名为YOLOD的新型目标检测模型，动机是为了提高人造革细小缺陷的检测性能，解决现有YOLOv5模型在小目标检测上的不足。

**2. 这篇论文试图解决什么问题？** 论文试图解决人造革细小缺陷的高效率和高准确性检测问题。

**3. 这是否是一个新的问题？** 这不是一个全新的问题，但在深度学习的帮助下，作者提出了新的解决方案来提高小目标检测的性能。

**4. 这篇文章要验证一个什么科学假设？** 文章要验证的科学假设是：通过创新的结构设计（DFP，IFF，AMP，EOS），可以显著提高YOLO系列算法在小目标检测上的平均精度（AP）和减少误检率（AE）。

**5. 有哪些相关研究？如何归类？谁是这一课题在领域内值得关注的研究员？** 相关研究包括YOLO系列算法、SSD、FPN、PAN等。这些可以归类为实时目标检测算法和特征融合技术。领域内值得关注的研究员包括Joseph Redmon、Ali Farhadi、Weisheng Li等。

**6. 论文中提到的解决方案之关键是什么？** 解决方案的关键在于设计的四种创新结构：DFP、IFF、AMP和EOS，这些结构共同提高了小目标的检测精度和减少了误检。

**7. 论文中的实验是如何设计的？** 实验设计包括在人造革缺陷数据集（ALD）和MS-COCO数据集上对YOLOD和YOLOv5进行比较。实验中控制了超参数和其他训练设置，以确保公平比较。

**8. 用于定量评估的数据集上什么？代码有没有开源？** 用于定量评估的数据集是MS-COCO数据集和人造革数据集（ALD）。论文没有明确提到代码是否开源。

**9. 论文中的实验及结果有没有很好地支持需要验证的科学假设？** 是的，实验结果表明YOLOD在ALD和MS-COCO数据集上都取得了比YOLOv5更好的性能，支持了论文的科学假设。

**10. 这篇论文到底有什么贡献？** 论文的主要贡献是提出了YOLOD模型，该模型通过四种创新结构改进了人造革细小缺陷的检测性能，并在小目标检测任务上取得了显著的性能提升。

**11. 下一步呢？有什么工作可以继续深入？** 下一步的工作可以包括进一步优化YOLOD模型，探索更有效的方法来提高小目标检测的准确性，或者将YOLOD模型应用于其他类型的缺陷检测任务。此外，可以考虑将模型扩展到更大规模的数据集，或者探索模型的可解释性和鲁棒性。

---

<img width="679" alt="yolod-fig1" src="https://github.com/user-attachments/assets/87d57341-722d-4f1c-be0d-1aceb2fa1ba1">

图1展示了YOLOD和YOLOv5在不同数据集和不同指标上的性能对比：

(a) MS-COCO数据集上的AP对比：

- 图表显示，YOLOD在MS-COCO数据集上的AP（平均精度）明显高于YOLOv5，随着GFlops的增加，YOLOD的AP持续上升，表现出更好的性能。

(b) MS-COCO数据集上的APS对比：

- 图表显示，YOLOD在MS-COCO数据集上的APS（小目标的平均精度）也优于YOLOv5，尤其是在较高GFlops时，YOLOD的APS有显著提升。

(c) 人造革数据集上的AP50对比：

- 图表显示，YOLOD在人工革数据集上的AP50（在IoU阈值为0.5时的平均精度）显著高于YOLOv5，随着GFlops的增加，YOLOD的AP50持续上升，表明其在检测细小缺陷方面的优势。

(d) 人造革数据集上的AE对比：

- 图表显示，YOLOD在人工革数据集上的AE（误检率）明显低于YOLOv5，随着GFlops的增加，YOLOD的AE持续下降，表明其误检率更低。

综上所述，YOLOD在MS-COCO和人造革数据集上均表现出色，尤其是在细小缺陷检测方面，显著优于YOLOv5。YOLOD通过引入DFP、IFF、AMP和EOS四种创新结构，提升了检测精度并降低了误检率。

---

<img width="713" alt="yolod-fig2" src="https://github.com/user-attachments/assets/c2574aa9-b3a1-413d-b0a3-e361e3ffeeba">

图2展示了人造革缺陷的两种类型：白斑和黑斑。

**白斑组（White spots group）：**

- **White spot（白斑）：** 图中左侧显示了一个白斑缺陷的示例。放大图展示了白斑的细节。
- **Stain（污渍）：** 图中中间显示了一个污渍缺陷的示例。放大图展示了污渍的细节。
- **Particle（颗粒）：** 图中右侧显示了一个颗粒缺陷的示例。放大图展示了颗粒的细节。

**黑斑组（Black spots group）：**

- **Insect mark（虫痕）：** 图中左侧显示了一个虫痕缺陷的示例。放大图展示了虫痕的细节。
- **Burn（烧痕）：** 图中中间显示了一个烧痕缺陷的示例。放大图展示了烧痕的细节。
- **Black spot（黑斑）：** 图中右侧显示了一个黑斑缺陷的示例。放大图展示了黑斑的细节。

图2通过展示白斑和黑斑两组缺陷的具体示例，帮助读者理解人造革缺陷的不同类型及其特征。这些缺陷的细节图有助于更好地识别和分类不同类型的缺陷，从而为后续的检测和处理提供参考。

---

<img width="723" alt="yolod-fig3" src="https://github.com/user-attachments/assets/7f4e44a6-f361-4fc7-a58a-b4cf211b3627">
图3展示了FPN（特征金字塔网络）和PAN（路径聚合网络）的结构，以及输入输出的流程。

**模型结构：**

1. **FPN部分：**
   
    - FPN部分位于图的左侧，主要由三个CSP（Cross Stage Partial）模块组成。
    - FPN通过自上而下的路径（从上到下的蓝色箭头）将高层特征逐步传递到低层特征。
2. **PAN部分：**
   
    - PAN部分位于图的右侧，也由三个CSP模块组成。
    - PAN通过自下而上的路径（从下到上的蓝色箭头）将低层特征逐步传递到高层特征。

**输入输出流程：**

- **输入：**
  
    - 输入图像首先经过FPN部分的处理，生成不同层次的特征图。
    - 这些特征图通过FPN的自上而下路径传递，逐步融合高层和低层特征。
- **输出：**
  
    - 在PAN部分，特征图通过自下而上的路径传递，进一步融合和增强特征。
    - 最终，特征图被传递到三个检测头（D1、D2、D3），分别对应不同尺度的检测任务。
    - 橙色虚线箭头表示检测头D3的网络路径，绿色虚线箭头表示检测头D1的网络路径。可以看出，橙色网络比绿色网络更深。

**总结：**

- FPN和PAN的结合使得模型能够更好地融合不同层次的特征，从而提高检测精度。
- 不同检测头（D1、D2、D3）对应不同尺度的检测任务，确保模型在处理不同大小的目标时都能表现出色。
- 图中未包含部分卷积和SPP（空间金字塔池化）模块，这些模块在实际应用中可能会进一步增强模型性能。

---

<img width="707" alt="yolod-fig4" src="https://github.com/user-attachments/assets/d414f47e-3f6e-4989-949b-ad7b011c13f6">
图4展示了DFP（双特征池）和PAN（路径聚合网络）的结构，以及输入输出的流程。

**模型结构：**

1. **DFP部分：**
   - DFP部分位于图的左侧，主要由三个CSP（Cross Stage Partial）模块和多个卷积层（Conv）组成。
   - 每个CSP模块后面连接一个IFF（干扰特征过滤）模块，用于过滤干扰特征。
   - DFP通过自上而下的路径（从上到下的蓝色箭头）将高层特征逐步传递到低层特征，并通过卷积层进一步处理特征。
2. **PAN部分：**
   - PAN部分位于图的右侧，也由三个CSP模块和多个SAM（空间注意力模块）组成。
   - PAN通过自下而上的路径（从下到上的蓝色箭头）将低层特征逐步传递到高层特征，并通过SAM模块增强特征。

**输入输出流程：**

- **输入：**
  - 输入图像首先经过DFP部分的处理，生成不同层次的特征图。
  - 这些特征图通过DFP的自上而下路径传递，逐步融合高层和低层特征。
  - 在DFP部分，特征图经过卷积层处理后，传递到PAN部分。
- **输出：**
  - 在PAN部分，特征图通过自下而上的路径传递，进一步融合和增强特征。
  - 最终，特征图被传递到三个检测头（D1、D2、D3），分别对应不同尺度的检测任务。
  - 橙色虚线箭头表示检测头D3的网络路径，绿色虚线箭头表示检测头D1的网络路径。可以看出，橙色网络比绿色网络更深。

**总结：**

- DFP和PAN的结合使得模型能够更好地融合不同层次的特征，从而提高检测精度。
- 不同检测头（D1、D2、D3）对应不同尺度的检测任务，确保模型在处理不同大小的目标时都能表现出色。
- 图中未包含部分卷积和SPP（空间金字塔池化）模块，这些模块在实际应用中可能会进一步增强模型性能。
- 通过引入IFF和SAM模块，模型能够更有效地过滤干扰特征和增强特征，从而提高检测性能。

---

<img width="802" alt="yolod-fig5" src="https://github.com/user-attachments/assets/7967f2a2-9eab-481c-b5bb-0505ad4a8b28">
图5展示了干扰特征过滤（Interference Feature Filtering，IFF）过程的具体步骤。

**干扰特征过滤过程：**

1. **特征图排序：**
   - 输入的特征图是一个批次中的多个特征图（每个特征图对应一个通道）。
   - 首先，对这些特征图按照均值值进行排序。排序的目的是找到特征图中最不重要的部分。

2. **找到最小的5%特征图：**
   - 在排序后的特征图中，找到均值值最小的5%特征图。这些特征图被认为是干扰特征，因为它们对最终的检测结果贡献较小。

3. **清除干扰特征：**
   - 将这些最小的5%特征图的值全部设为零。这一步是为了清除这些干扰特征，从而减少它们对后续处理的影响。

4. **恢复特征图顺序：**
   - 最后，恢复特征图的原始顺序。经过干扰特征过滤后的特征图将继续用于后续的检测任务。

**总结：**
- 干扰特征过滤过程通过识别和清除特征图中最不重要的部分，减少了干扰特征对模型性能的负面影响。
- 这一过程有助于提高模型的检测精度，因为它确保了模型只关注那些对检测任务最有贡献的特征。
- 图5详细展示了这一过程的每一步，帮助理解干扰特征过滤的具体实现方法。

---

<img width="814" alt="yolod-fig6" src="https://github.com/user-attachments/assets/eee68270-f28b-4e10-acc3-e12488cd3625">
图6展示了两种添加正样本的方法：YOLOv5的方法和另一种改进的方法。

**图表分析：**

1. **Panel (a) - YOLOv5的方法：**
   - 图(a)展示了YOLOv5添加正样本的方法。
   - 在这个方法中，正样本（橙色点）被添加在网格的中心位置。
   - 以网格中心为基准，正样本的添加范围是0.5个网格的距离（即0.5 grid）。
   - 这种方法确保了正样本在网格中心附近，但可能会忽略一些边缘区域的正样本。
2. **Panel (b) - 改进的方法：**
   - 图(b)展示了改进后的添加正样本的方法。
   - 在这个方法中，正样本（绿色点）被添加在网格的左上角。
   - 以网格左上角为基准，正样本的添加范围是0.35个网格的距离（即0.35 grid）。
   - 这种方法同样确保了正样本的欧几里得距离从新的正样本到真实值中心为0.5个网格，与YOLOv5的方法一致。
   - 通过这种改进的方法，可以更好地覆盖网格的边缘区域，从而增加正样本的多样性和分布范围。

**总结：**

- YOLOv5的方法（图a）主要集中在网格中心附近添加正样本，可能会忽略边缘区域。
- 改进的方法（图b）通过在网格左上角添加正样本，扩大了正样本的覆盖范围，确保了更多区域的正样本被考虑。
- 两种方法的欧几里得距离都为0.5个网格，但改进的方法在正样本的分布上更加均匀和多样化，有助于提高模型的检测性能。

---

<img width="832" alt="yolod-fig7" src="https://github.com/user-attachments/assets/57b918a3-3b83-432f-ac00-ddef224938df">
图7展示了不同条件下的Sigmoid函数曲线。图(a)展示了当尺度（scale）取不同值时的Sigmoid函数曲线，而图(b)展示了当尺度为3并添加EOS（End of Sequence）时的Sigmoid函数曲线。

**图表分析：**

1. **Panel (a) - 不同尺度下的Sigmoid函数曲线：**
    
    - 图(a)展示了三条Sigmoid函数曲线，分别对应不同的尺度值（scale=1、scale=2、scale=3）。
    - 当尺度值增加时，Sigmoid函数的曲线变得更加陡峭。
        - **Scale=1（蓝色曲线）**：曲线较为平缓，表示Sigmoid函数的输出变化较慢。
        - **Scale=2（红色曲线）**：曲线变得稍微陡峭，表示Sigmoid函数的输出变化速度增加。
        - **Scale=3（绿色曲线）**：曲线最为陡峭，表示Sigmoid函数的输出变化最快。
    - 通过调整尺度值，可以控制Sigmoid函数的输出变化速度，从而影响模型的激活函数行为。
2. **Panel (b) - 添加EOS后的Sigmoid函数曲线：**
    
    - 图(b)展示了当尺度为3并添加EOS时的Sigmoid函数曲线。
    - 添加EOS后，Sigmoid函数的曲线在高值和低值区域变得更加平缓，而在中间区域仍然保持陡峭。
        - **Scale=3（蓝色曲线）**：与图(a)中的绿色曲线相同，表示未添加EOS时的Sigmoid函数曲线。
        - **Scale=3 + EOS（红色曲线）**：添加EOS后的曲线，在高值和低值区域变得更加平缓。
    - 添加EOS的目的是在Sigmoid函数的输出中引入一个终止序列，使得在高值和低值区域的输出变化更加平缓，从而减少极端值对模型的影响。

**总结：**

- 图(a)展示了不同尺度值对Sigmoid函数曲线的影响，尺度值越大，曲线越陡峭。
- 图(b)展示了在尺度为3的情况下，添加EOS对Sigmoid函数曲线的影响，添加EOS使得曲线在高值和低值区域变得更加平缓。
- 通过调整尺度值和添加EOS，可以控制Sigmoid函数的输出变化速度和范围，从而影响模型的激活函数行为和性能。