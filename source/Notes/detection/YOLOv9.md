# YOLOv9

**标题：** YOLOv9: Learning What You Want to Learn Using Programmable Gradient Information

**作者：** Chien-Yao Wang, I-Hau Yeh, Hong-Yuan Mark Liao (Institute of Information Science, Academia Sinica, Taiwan; National Taipei University of Technology, Taiwan; Department of Information and Computer Engineering, Chung Yuan Christian University, Taiwan)

**摘要：**
YOLOv9是一个新的目标检测系统，它通过提出可编程梯度信息（Programmable Gradient Information, PGI）和一个新的轻量级网络架构——Generalized Efficient Layer Aggregation Network (GELAN)——来解决深度网络中信息瓶颈问题。PGI能够为目标任务提供完整的输入信息以计算目标函数，从而获得可靠的梯度信息来更新网络权重。GELAN基于梯度路径规划设计，证明了PGI在轻量级模型上取得了优越的结果。实验结果表明，YOLOv9在MS COCO数据集上的目标检测性能超过了现有的实时目标检测器。

**1. 问题：**
论文试图解决深度学习模型在目标检测任务中由于信息瓶颈导致的信息丢失问题，这可能导致梯度信息不可靠，从而影响模型的预测准确性。

**2. 新问题：**
信息瓶颈问题在深度学习领域是一个已知问题，但PGI和GELAN的提出为解决这一问题提供了新的视角和方法。

**3. 科学假设：**
假设通过PGI和GELAN可以更有效地保留和利用输入数据的关键特征，从而提高目标检测的准确性。

**4. 相关研究：**
- 实时目标检测器：YOLO系列、SSD、RetinaNet等。
- 可逆架构：如RevCol、Res2Net、CBNet等。
- 辅助监督：深度监督、多尺度特征学习等。
- 领域内值得关注的研究员包括但不限于Joseph Redmon、Ali Farhadi（YOLO系列的主要贡献者）。

**5. 解决方案关键：**
PGI和GELAN。PGI通过辅助可逆分支生成可靠的梯度信息，而GELAN则是一种轻量级的网络架构，它基于梯度路径规划设计，能够适应不同的计算块和深度设置。

**6. 实验设计：**
实验在MS COCO数据集上进行，使用YOLOv7 AF作为基础模型，通过替换ELAN为GELAN并引入PGI来构建YOLOv9。所有模型从头开始训练，训练周期为500个epoch。

**7. 数据集与代码：**
使用的数据集是MS COCO 2017分割版。源代码已在GitHub上开源：https://github.com/WongKinYiu/yolov9。

**8. 实验结果：**
YOLOv9在MS COCO数据集上取得了优异的性能，超过了现有的实时目标检测器，这支持了论文提出的科学假设。

**9. 贡献：**
- 提出了PGI，解决了深度监督机制不适用于轻量级神经网络的问题。
- 设计了GELAN，一种高效的轻量级神经网络架构。
- YOLOv9结合了PGI和GELAN，在目标检测任务上取得了优异的性能。

**10. 下一步工作：**
- 进一步探索PGI和GELAN在其他视觉任务中的应用。
- 在更大的数据集上测试YOLOv9的性能。
- 探索更多可逆架构和辅助监督技术以提高模型性能。

回答问题

1. **问题：** 解决深度学习模型在目标检测中因信息瓶颈导致的问题。
2. **新问题：** 不是新问题，但提供了新的解决方案。
3. **科学假设：** PGI和GELAN可以提高目标检测的准确性。
4. **相关研究：** YOLO系列、可逆架构、辅助监督等。
5. **解决方案关键：** PGI和GELAN。
6. **实验设计：** 在MS COCO数据集上进行，500个训练周期。
7. **数据集与代码：** MS COCO数据集，代码已开源。
8. **实验结果：** 支持假设，YOLOv9性能优异。
9. **贡献：** 提出了PGI和GELAN，设计了YOLOv9。
10. **下一步工作：** 探索PGI和GELAN在其他任务中的应用，测试更大数据集上的性能。

解决方案关键

**可编程梯度信息（PGI）：**
PGI是本文提出的一个新概念，旨在解决深度神经网络在训练过程中由于信息瓶颈导致的信息丢失问题。PGI通过辅助可逆分支生成可靠的梯度信息，这些信息用于更新网络参数，确保深度特征能够保持对执行目标任务至关重要的特征。PGI的可逆架构建立在辅助分支上，不增加额外的推理成本。PGI还允许自由选择适合目标任务的损失函数，克服了掩码建模中的问题。

**通用高效层聚合网络（GELAN）：**
GELAN是本文提出的一个新的轻量级网络架构，基于梯度路径规划设计。GELAN的设计考虑了参数数量、计算复杂性、准确性和推理速度，使用户可以为不同的推理设备选择适当的计算块。GELAN的架构证明了PGI在轻量级模型上能够获得优越的结果。

实验设计

**数据集：**
实验使用了MS COCO数据集，这是目标检测领域广泛使用的标准数据集，包含多种类别的对象。

**训练设置：**
所有模型从头开始训练，没有使用预训练模型。训练使用了300个epoch，其中前5个epoch为热身阶段，仅更新偏置。使用随机梯度下降（SGD）优化器进行训练，初始学习率为0.01，并采用线性衰减策略。权重衰减设置为0.0005，动量为0.9。批量大小为128，输入尺寸在448到832之间均匀抽取，步长为32。

**数据增强：**
实验中使用了包括随机水平翻转、颜色抖动、多尺度增强和马赛克增强在内的数据增强技术。在训练的最后15个epoch中关闭了马赛克数据增强。

**评估：**
在Tesla V100 GPU上，使用FP16精度和批量大小为1进行评估。报告的FPS（帧每秒）和延迟都是在这个设置下测量的。

实验结果

**性能提升：**
实验结果表明，YOLOv9在不同模型尺寸上均取得了优异的性能。例如，YOLOv9-S在参数和计算量较少的情况下，相比YOLOv7 AF，有显著的性能提升。YOLOv9-E在保持准确性的同时，相比于YOLOv8减少了参数数量和计算量。

**与其他方法的比较：**
YOLOv9在与其他实时目标检测器的比较中表现出色，包括与基于Transformer的检测器和基于卷积的检测器的比较。YOLOv9在速度和准确性上都超过了这些方法。

**不同训练方法的比较：**
YOLOv9在不同的训练方法（包括从头训练、ImageNet预训练、知识蒸馏和复杂设置）中都展现了优越的性能，证明了其在参数利用效率和计算复杂性与准确性之间取得了良好的平衡。

**可视化：**
通过可视化特征图，展示了不同架构在不同深度下保留信息的能力。GELAN和YOLOv9（GELAN + PGI）在较深的层次上仍能保留足够的信息，而其他架构则随着层数的增加逐渐丢失了重要信息。

结论

YOLOv9通过PGI和GELAN的结合，解决了深度学习中的信息瓶颈问题，特别是在轻量级神经网络中。YOLOv9在目标检测任务上显示出强大的竞争力，其设计使得深度模型在减少参数数量和计算量的同时，仍然提高了准确性。


关闭马赛克增强的好处是什么？
马赛克增强（Mosaic Augmentation）是一种数据增强技术，它通过将四个随机选择的训练图像切割并重新排列成一个新的图像来增加数据的多样性，从而提高模型的泛化能力。这种技术可以模拟更多的场景变化，帮助模型学习到更加鲁棒的特征表示。 在论文中提到的实验设计里，作者在训练的最后15个epoch关闭了马赛克数据增强，这可能是基于以下几点考虑：

1. **模型稳定化**：在训练的后期阶段，模型可能已经学习到了足够的特征，此时关闭数据增强可以使得模型在这些特征上更加稳定，避免过度拟合。
2. **准确度提升**：数据增强通常会带来一些噪声，这在训练初期有助于模型学习泛化能力，但在训练后期可能会干扰模型对真实特征的学习。关闭增强可以帮助模型更准确地学习数据集中的模式。
3. **模拟真实环境**：在训练的最后阶段，减少或关闭数据增强可以让模型更多地接触到未经增强的、更接近真实环境的数据，这有助于提高模型在实际应用中的性能。
4. **计算效率**：数据增强会增加训练的计算负担。在训练后期关闭某些数据增强方法可以提高训练的效率，尤其是在资源有限的情况下。
5. **超参数调整**：关闭马赛克增强可能是超参数调整的一部分，作者可能通过实验发现，在训练后期关闭马赛克增强能够获得更好的性能表现。 需要注意的是，这些好处并不是绝对的，它们可能依赖于具体的应用场景、数据集特性以及模型的当前状态。在实际应用中，是否关闭数据增强以及何时关闭，需要根据具体情况和实验结果来决定。