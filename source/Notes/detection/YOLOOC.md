# YOLOOC

作者：Qian Wan, Xiang Xiang, Qinhao Zhou, 华中科技大学

**摘要：** 本文提出了一种新的开放世界目标检测（OWOD）问题，即模型在检测到新类别后如何增量式地学习它们而不忘记以前已知的类别。作者构建了一个新的基准，其中新类别仅在推理阶段遇到，并提出了一个新的OWOD检测器YOLOOC，它基于YOLO架构，引入了标签平滑技术以防止检测器过度自信地将新类别映射到已知类别，并发现新类别。

**1. 解决的问题：** 论文试图解决开放世界目标检测（OWOD）问题，即模型如何检测并增量学习新类别，同时保留对已知类别的检测能力。

**2. 是否是新问题：** 是的，这是一个新问题，特别是在构建的基准中，新类别仅在推理阶段出现，这使得问题更具挑战性。

**3. 科学假设：** 假设通过标签平滑技术可以减少模型对已知类别特征的过度拟合，从而提高对新类别的检测能力。

**4. 相关研究：**

- 目标检测：RCNN, Fast RCNN, Faster RCNN, YOLO系列。
- 开放集目标检测：ORE, OW-DETR, RE-OWOD。
- 新类别发现：基于原型学习、对比学习等方法。 相关研究可以归类为目标检测、开放集目标检测和新类别发现。领域内值得关注的研究员包括但不限于上述方法的作者。

**5. 解决方案关键：** YOLOOC的关键解决方案是引入标签平滑技术，这有助于模型在训练时不过度拟合已知类别的特征，从而在推理阶段能够更好地检测到新类别。

**6. 实验设计：** 实验基于COCO数据集构建了一个新的基准，模拟了新类别仅在推理阶段出现的情况。评估指标包括对已知类别的mAP和对新类别的召回率（U-Recall）。

**7. 数据集和代码：** 使用COCO 2017数据集进行实验。论文中没有明确提到代码是否开源。

**8. 实验结果支持假设：** 实验结果表明，YOLOOC在新基准上对新类别的检测性能优于现有的OWOD检测器，如ORE和OW-DETR，这支持了标签平滑技术有助于提高新类别检测能力的假设。

**9. 论文贡献：**

- 提出了一个新的OWOD基准，其中新类别仅在推理阶段遇到。
- 提出了YOLOOC，一个基于YOLO的OWOD检测器，通过标签平滑技术提高了新类别的检测能力。
- 在新基准上进行了广泛的实验，验证了YOLOOC的有效性。

**10. 下一步工作：** 未来的工作可以继续深入研究如何提高新类别的检测和识别性能，探索更有效的标签平滑技术，以及如何在增量学习中更好地保留对已知类别的记忆。此外，构建更大规模的、完全标注的、只包含已知类别的训练数据集也是未来工作的一个方向。

回答问题：

1. 解决的问题：开放世界目标检测中的新类别检测和增量学习问题。
2. 新问题：是的，特别是在提出的新基准中。
3. 科学假设：标签平滑技术可以提高新类别的检测能力。
4. 相关研究：目标检测、开放集目标检测和新类别发现的相关研究。
5. 解决方案关键：标签平滑技术。
6. 实验设计：在COCO数据集上构建新基准，评估模型对已知和新类别的检测能力。
7. 数据集和代码：使用COCO数据集，代码开源情况未明确。
8. 实验结果支持假设：是的，YOLOOC在新基准上的性能支持了假设。
9. 论文贡献：提出了新的OWOD基准和检测器YOLOOC，并通过实验验证了其有效性。
10. 下一步工作：提高新类别检测性能，探索更有效的标签平滑技术，以及构建更大规模的训练数据集。

---

<img width="1043" alt="yolooc-fig1" src="https://github.com/user-attachments/assets/e3eec7b3-5eea-4f06-bd44-dd6bc5ee2045">
这个图表展示了一个模型在已知类别（从VOC数据集中选择的20个已知类别）和新类别（从COCO数据集中选择的60个新类别）上的检测结果。图表分为两部分：(a) 和 (b)。

(a) 图中，模型错误地将两只熊识别为牛和鸟。 (b) 图中，模型将一头大象和一头犀牛分别识别为马和羊。需要注意的是，COCO标签中并不包含犀牛这一类别。

总结结论：

1. 该模型在已知类别上的表现较好，但在新类别上的表现存在明显错误。
2. 模型在处理新类别时，容易将其误识别为已知类别中的某一类。
3. 这种误识别表明模型在泛化到新类别时存在局限性，可能需要进一步的训练和优化以提高其在新类别上的识别准确性。

---

<img width="1379" alt="yolooc-fig2" src="https://github.com/user-attachments/assets/d10602ea-e22f-4451-9be9-5887e372b43f">

这个图表展示了一个开放世界物体检测基准测试的增量学习过程。图表分为三个任务（Task 1, Task 2, Task N），每个任务都有训练集和测试集。

图表分析：

1. **Task 1**:
    
    - **训练集**：包含“人”和“交通灯”两个已知类别。
    - **测试集**：包含“人”和“交通灯”两个已知类别，以及“摩托车”、“食物”、“公交车”、“蝙蝠”等未知类别。
2. **Task 2**:
    
    - **训练集**：包含“人”、“交通灯”、“食物”和“公交车”四个已知类别。
    - **测试集**：包含“人”、“交通灯”、“食物”和“公交车”四个已知类别，以及“摩托车”、“玩具”、“汽车”、“蝙蝠”等未知类别。
3. **Task N**:
    
    - **训练集**：包含“人”、“交通灯”、“食物”、“公交车”、“玩具”和“汽车”六个已知类别。
    - **测试集**：包含“人”、“交通灯”、“食物”、“公交车”、“玩具”和“汽车”六个已知类别，以及“摩托车”、“蝙蝠”等未知类别。

结论：

1. **增量学习**：每个任务的训练集都会增加新的已知类别，而测试集则包含所有已知类别和一些未知类别。这种增量学习方法使得模型能够逐步学习新的类别，同时保留对之前已知类别的识别能力。
    
2. **开放集检测**：在测试集中，模型不仅需要识别已知类别，还需要处理未知类别。这种开放集检测方法要求模型具有更强的泛化能力，以应对现实世界中可能出现的各种新类别。
    
3. **类增量学习**：在每个增量任务中，模型需要记住之前学到的类别，并在此基础上学习新的类别。这种类增量学习方法有助于模型在不断扩展其知识库的同时，避免遗忘之前学到的信息。
    

总的来说，这个图表展示了一个开放世界物体检测基准测试的增量学习过程，强调了模型在处理新类别时的泛化能力和记忆保留能力。

---

<img width="1011" alt="yolooc-fig3" src="https://github.com/user-attachments/assets/70365de8-9575-4e23-a498-56cfd44e0faf">
流程介绍：

1. **模型结构**：
    
    - **Backbone**：基础网络，用于提取图像的低级和中级特征。
    - **Neck**：中间层，用于进一步处理和融合特征。
    - **Head**：头部，用于最终的分类和回归任务，输出检测结果。
2. **训练阶段**：
    
    - **训练图像**：输入包含已知类别（如“人”）的图像。
    - **传统独热编码问题**：传统的独热编码使得模型对已知类别的特征过度拟合，并对其预测过于自信，这在遇到新类别时会导致性能显著下降。
    - **标签平滑（Label Smoothing）**：在训练过程中引入标签平滑技术，通过将独热编码的标签进行平滑处理，使模型对所学特征的自信度降低，从而减少过度拟合。这种方法使得模型在面对新类别时表现更为稳健。
3. **测试阶段**：
    
    - **测试图像**：输入包含已知类别和未知类别的图像。
    - **非极大值抑制（NMS）**：用于去除冗余的检测框，保留最有可能的检测结果。
    - **校准函数（Calibration Function）**：在测试阶段引入校准函数，用于区分已知类别和新类别。这一步骤有助于提高模型在开放世界环境中的泛化能力，使其能够更准确地识别新类别。

结论：

1. **标签平滑的引入**：通过在训练过程中引入标签平滑，模型对已知类别的特征自信度降低，从而减少了过度拟合。这使得模型在遇到新类别时，性能不会显著下降。
    
2. **校准函数的应用**：在测试阶段引入校准函数，有助于模型在已知类别和新类别之间进行区分，提高了模型在开放世界环境中的泛化能力。
    
3. **整体改进**：该流程通过在训练和测试阶段的改进，使得模型在处理新类别时表现更为稳健，减少了传统独热编码带来的过度拟合问题。
    

总的来说，这个流程展示了一种改进的物体检测方法，通过标签平滑和校准函数的引入，提高了模型在开放世界环境中的性能和泛化能力。

---

<img width="1271" alt="yolooc-fig5" src="https://github.com/user-attachments/assets/9fcb9c05-0255-4965-b067-c7a656da1b5b">
这个图表展示了对缩放参数 λ 的消融研究，分析了不同 λ 值对封闭集（close-set）和开放集（open-set）性能的影响。图表分为两个子图：(a) 封闭集性能和 (b) 开放集性能。

图表分析：

1. **封闭集性能 (a)**：
    
    - 横轴表示缩放参数 λ 的值，从 0 到 1。
    - 纵轴表示封闭集中的平均精度均值（mAP）。
    - 不同颜色的曲线（蓝色、橙色、绿色、红色）代表不同的模型或实验设置（标记为 m、n、o、x）。
2. **开放集性能 (b)**：
    
    - 横轴表示缩放参数 λ 的值，从 0 到 1。
    - 纵轴表示开放集中的平均精度均值（mAP）。
    - 不同颜色的曲线（蓝色、橙色、绿色、红色）代表不同的模型或实验设置（标记为 m、n、o、x）。

结论：
1. **封闭集性能**：
    
    - 随着 λ 值的增加，所有模型的封闭集性能（mAP）都呈现下降趋势。
    - 在 λ 值较小时（接近 0），不同模型的性能差异较小，且 mAP 较高。
    - 当 λ 值接近 1 时，性能下降显著，表明过大的 λ 值会对封闭集性能产生负面影响。
2. **开放集性能**：
    
    - 随着 λ 值的增加，所有模型的开放集性能（mAP）也呈现下降趋势。
    - 在 λ 值较小时（接近 0），不同模型的性能差异较小，且 mAP 较高。
    - 当 λ 值接近 1 时，性能下降显著，表明过大的 λ 值会对开放集性能产生负面影响。
3. **整体趋势**：
    
    - 无论是封闭集还是开放集，缩放参数 λ 的增加都会导致性能下降。
    - 适中的 λ 值（接近 0）有助于保持较高的 mAP，而过大的 λ 值（接近 1）会显著降低模型性能。
总的来说，这个图表展示了缩放参数 λ 对模型性能的影响，表明在选择 λ 值时需要谨慎，过大的 λ 值会对封闭集和开放集的性能都产生负面影响。适中的 λ 值有助于保持较高的平均精度均值（mAP）。


---

<img width="1288" alt="yolooc-fig6" src="https://github.com/user-attachments/assets/f4953743-d9fd-4162-95ff-834a6fed0927">

这个图表展示了输出类别概率的直方图，分别针对已知类别和新类别，并且比较了使用标签平滑（label smoothing）和不使用标签平滑的情况。图表分为四个子图：(a) 已知类别，(b) 使用标签平滑的已知类别，(c) 新类别，(d) 使用标签平滑的新类别。

图表分析：

1. **已知类别 (a)**：
    
    - 横轴表示输出类别的概率，从 0 到 1。
    - 纵轴表示模型在每个概率区间内的预测数量。
    - 直方图显示大多数预测的概率接近 1，表明模型对已知类别的预测非常自信。
2. **使用标签平滑的已知类别 (b)**：
    
    - 横轴表示输出类别的概率，从 0 到 1。
    - 纵轴表示模型在每个概率区间内的预测数量。
    - 直方图显示大多数预测的概率仍然较高，但相比 (a) 图，概率分布更为平滑，表明标签平滑降低了模型的过度自信。
3. **新类别 (c)**：
    
    - 横轴表示输出类别的概率，从 0 到 1。
    - 纵轴表示模型在每个概率区间内的预测数量。
    - 直方图显示大多数预测的概率较低，表明模型对新类别的预测不自信。
4. **使用标签平滑的新类别 (d)**：
    
    - 横轴表示输出类别的概率，从 0 到 1。
    - 纵轴表示模型在每个概率区间内的预测数量。
    - 直方图显示概率分布更为均匀，表明标签平滑使模型对新类别的预测更加分散，减少了极端低概率的情况。

结论：

1. **已知类别的预测**：
    
    - 在没有标签平滑的情况下，模型对已知类别的预测非常自信，大多数预测的概率接近 1。
    - 使用标签平滑后，模型对已知类别的预测概率分布更为平滑，减少了过度自信的情况。
2. **新类别的预测**：
    
    - 在没有标签平滑的情况下，模型对新类别的预测不自信，大多数预测的概率较低。
    - 使用标签平滑后，模型对新类别的预测概率分布更为均匀，减少了极端低概率的情况，表明标签平滑有助于模型在新类别上的表现。
3. **标签平滑的效果**：
    
    - 标签平滑在已知类别上减少了模型的过度自信，使预测概率分布更为平滑。
    - 在新类别上，标签平滑使模型的预测更加分散，减少了极端低概率的情况，提高了模型在新类别上的表现。

总的来说，这个图表展示了标签平滑对模型预测概率分布的影响，表明标签平滑可以有效减少模型的过度自信，并在新类别上提高模型的表现。

